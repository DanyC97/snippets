

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.3.1.2. bct.nbs.nbs_bct &mdash; Snippets 1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon-penn.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Snippets 1 documentation" href="../index.html"/>
        <link rel="up" title="6.3. bct.nbs" href="bct.nbs.html"/>
        <link rel="next" title="6.3.2.1. bct.nbs.BCTParamError" href="bct.nbs.BCTParamError.html"/>
        <link rel="prev" title="6.3.1.1. bct.nbs.get_components" href="bct.nbs.get_components.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Snippets
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cs-bash-commands.html">1. bash-commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-bash-scripts.html">2. bash-scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-qsubber.html">3. qsubber</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-python.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-pyspark.html">5. pyspark</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../bct.html">6. Brain Connectivity Toolbox</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bct.algorithms.html">6.1. bct.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="bct.utils.html">6.2. bct.utils</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bct.nbs.html">6.3. bct.nbs</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bct.nbs.html#functions">6.3.1. Functions</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bct.nbs.get_components.html">6.3.1.1. bct.nbs.get_components</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">6.3.1.2. bct.nbs.nbs_bct</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bct.nbs.html#exceptions">6.3.2. Exceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cs-git.html">7. git-snippet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configs/configs.html">8. configs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-R.html">9. R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-awk-oneliners.html">10. awk-oneliners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-perl-oneliners.html">11. perl one-liners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-py-jupyter-notebook.html">12. python-jupyter-notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-regexp.html">13. regular expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-rst-old.html">14. rst cheatsheet (old)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-sed.html">15. sed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-sql.html">16. sql</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-scala.html">17. Scala</a></li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tutorial/index.html">18. awk-tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sed-tutorial/index.html">19. Sed things</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Snippets</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../bct.html">6. Brain Connectivity Toolbox</a> &raquo;</li>
        
          <li><a href="bct.nbs.html">6.3. bct.nbs</a> &raquo;</li>
        
      <li>6.3.1.2. bct.nbs.nbs_bct</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/bct.nbs.nbs_bct.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bct-nbs-nbs-bct">
<h1>6.3.1.2. bct.nbs.nbs_bct<a class="headerlink" href="#bct-nbs-nbs-bct" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="bct.nbs.nbs_bct">
<code class="descclassname">bct.nbs.</code><code class="descname">nbs_bct</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>thresh</em>, <em>k=1000</em>, <em>tail='both'</em>, <em>paired=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bct/nbs.html#nbs_bct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bct.nbs.nbs_bct" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the NBS for populations X and Y for a t-statistic threshold of
alpha.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : NxNxP np.ndarray</p>
<blockquote>
<div><p>matrix representing the first population with P subjects. must be
symmetric.</p>
</div></blockquote>
<p><strong>y</strong> : NxNxQ np.ndarray</p>
<blockquote>
<div><p>matrix representing the second population with Q subjects. Q need not
equal P. must be symmetric.</p>
</div></blockquote>
<p><strong>thresh</strong> : float</p>
<blockquote>
<div><p>minimum t-value used as threshold</p>
</div></blockquote>
<p><strong>k</strong> : int</p>
<blockquote>
<div><p>number of permutations used to estimate the empirical null 
distribution</p>
</div></blockquote>
<p><strong>tail</strong> : {&#8216;left&#8217;, &#8216;right&#8217;, &#8216;both&#8217;}</p>
<blockquote>
<div><p>enables specification of particular alternative hypothesis
&#8216;left&#8217; : mean population of X &lt; mean population of Y
&#8216;right&#8217; : mean population of Y &lt; mean population of X
&#8216;both&#8217; : means are unequal (default)</p>
</div></blockquote>
<p><strong>paired</strong> : bool</p>
<blockquote>
<div><p>use paired sample t-test instead of population t-test. requires both
subject populations to have equal N. default value = False</p>
</div></blockquote>
<p><strong>verbose</strong> : bool</p>
<blockquote>
<div><p>print some extra information each iteration. defaults value = False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> : Cx1 np.ndarray</p>
<blockquote>
<div><p>A vector of corrected p-values for each component of the networks
identified. If at least one p-value is less than alpha, the omnibus
null hypothesis can be rejected at alpha significance. The null
hypothesis is that the value of the connectivity from each edge has
equal mean across the two populations.</p>
</div></blockquote>
<p><strong>adj</strong> : IxIxC np.ndarray</p>
<blockquote>
<div><p>an adjacency matrix identifying the edges comprising each component.
edges are assigned indexed values.</p>
</div></blockquote>
<p><strong>null</strong> : Kx1 np.ndarray</p>
<blockquote class="last">
<div><p>A vector of K sampled from the null distribution of maximal component 
size.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>ALGORITHM DESCRIPTION 
The NBS is a nonparametric statistical test used to isolate the 
components of an N x N undirected connectivity matrix that differ 
significantly between two distinct populations. Each element of the 
connectivity matrix stores a connectivity value and each member of 
the two populations possesses a distinct connectivity matrix. A 
component of a connectivity matrix is defined as a set of 
interconnected edges.</p>
<p>The NBS is essentially a procedure to control the family-wise error 
rate, in the weak sense, when the null hypothesis is tested 
independently at each of the N(N-1)/2 edges comprising the undirected
connectivity matrix. The NBS can provide greater statistical power 
than conventional procedures for controlling the family-wise error 
rate, such as the false discovery rate, if the set of edges at which
the null hypothesis is rejected constitues a large component or
components.
The NBS comprises fours steps:
1. Perform a two-sample T-test at each edge indepedently to test the</p>
<blockquote>
<div>hypothesis that the value of connectivity between the two
populations come from distributions with equal means.</div></blockquote>
<ol class="arabic simple" start="2">
<li>Threshold the T-statistic available at each edge to form a set of
suprathreshold edges.</li>
<li>Identify any components in the adjacency matrix defined by the set
of suprathreshold edges. These are referred to as observed 
components. Compute the size of each observed component 
identified; that is, the number of edges it comprises.</li>
<li>Repeat K times steps 1-3, each time randomly permuting members of
the two populations and storing the size of the largest component 
identified for each permuation. This yields an empirical estimate
of the null distribution of maximal component size. A corrected 
p-value for each observed component is then calculated using this
null distribution.</li>
</ol>
<dl class="docutils">
<dt>[1] Zalesky A, Fornito A, Bullmore ET (2010) Network-based statistic:</dt>
<dd>Identifying differences in brain networks. NeuroImage.
10.1016/j.neuroimage.2010.06.041</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bct.nbs.BCTParamError.html" class="btn btn-neutral float-right" title="6.3.2.1. bct.nbs.BCTParamError" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bct.nbs.get_components.html" class="btn btn-neutral" title="6.3.1.1. bct.nbs.get_components" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Takanori Watanabe.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>